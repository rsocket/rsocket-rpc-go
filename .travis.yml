language: go

go:
  - '1.12'

env:
  - GO111MODULE=on

install:
  - curl -L https://github.com/google/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip -o /tmp/protoc.zip
  - unzip /tmp/protoc.zip -d "$HOME"/protoc
  - go get -u golang.org/x/lint/golint
  - go get -u github.com/golangci/golangci-lint/cmd/golangci-lint
  - go get -u github.com/rsocket/rsocket-rpc-go/protoc-gen-go

script:
  - go test -v .
  - $HOME/protoc/bin/protoc --go_out=plugins=rrpc:./examples/ping-pong ./examples/ping-pong.proto
  - go test -v ./examples/ping-pong/ping-pong_test.go
